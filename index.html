<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>素数判定・素因数分解・進数変換</title>
<script>
    function hantei(target) {
        var count = 0;
        for (var i = 1; i < target + 1; i++) {
            if (Number.isInteger(target / i) == true) {
                if (i != 1 && i != target) {
                    break;
                    return '素数ではありません';
                } else {
                    count++;
                }
            }
        }
        if (count == 2) {
            return '素数です';
        } else {
            return '素数ではありません';
        }
    }

    function bunkai(target) {
        var Num = target;
        var factor_list = [];
        if (hantei(Num) == '素数ではありません' && Num > 2) {
            while (Num > 1) {
                for (var i = 1; i < Num + 1; i++) {
                    if (hantei(i) == '素数です' && Number.isInteger(Num / i) == true) {
                        factor_list.push(i);
                        Num = Num / i;
                        break;
                    }
                    if (hantei(Num) == '素数です') {
                        factor_list.push(Num);
                        Num = 1;
                        break;
                    }
                }
            }

            var count = 0;
            var count_list = [];
            for (var i = 0; i < factor_list.length; i++) {
                if (factor_list[i] == factor_list[i + 1]) {
                    count++;
                } else if (factor_list[i] != factor_list[i + 1]) {
                    count++;
                    count_list.push(count);
                    count = 0;
                }
            }
            var factor_indication = '';
            var progress = 0;
            for (var i = 0; i < factor_list.length; i++) {
                if (i == 0) {
                    factor_indication = factor_list[i];
                } else if (factor_list[i] == factor_list[i - 1] && factor_list[i] != factor_list[i + 1]) {
                    factor_indication = factor_indication + '^' + count_list[progress];
                } else if (factor_list[i] != factor_list[i - 1]) {
                    factor_indication = factor_indication + ' × ' + factor_list[i];
                }
                if (factor_list[i] != factor_list[i + 1]) {
                    progress++;
                }
            }
            document.getElementById('answer').textContent = factor_indication;
        } else {
            document.getElementById('answer').textContent = 'この数字は分解できません';
        }
    }

    function nishinhenkann(target) {
        var digits = 1;
        var max = 1;
        var digits_max = 1;
        while (target > max) {
            max = 1;
            digits_max = 1;
            for (var i = 0; i < digits; i++) {
                digits_max = digits_max * 2;
                max = max + digits_max;
            }
            digits++;
        }
        var digits_decision = target;
        var answer = '';
        for (var i = 0; i < digits; i ++) {
            var digits_down = 1;
            for (var j = 0; j < i; j++) {
                digits_down = digits_down / 2;
            }
            if (digits_decision >= digits_max * digits_down) {
                digits_decision = digits_decision - digits_max * digits_down;
                answer = answer + '1';
            } else {
                answer = answer + '0';
            }
        }
        document.getElementById('answer').textContent = answer;
    }

    function jisshinhenkann(target) {
        var Number_list = [];
        for (var i = 0; i < String(target).length; i++) {
            Number_list.push(String(target).slice(i, i + 1));
        }
        var answer = 0;
        var digits_magnification = 1;
        for (var i = Number_list.length - 1; i >= 0; i--) {
            answer = answer + Number_list[i] * digits_magnification;
            digits_magnification = digits_magnification * 2;
        }
        document.getElementById('answer').textContent = answer;
    }

    function mode_change() {
        var input_textbox = document.getElementById('Number_slot').value;
        var input_Number = Number(input_textbox.replace(/,/, ''));
        if (Number.isInteger(input_Number) == true && input_textbox.trim().length != 0) {
            var mode = document.getElementById('mode_select').value;
            if (mode == 'hantei') {
                if (hantei(input_Number) == '素数です') {
                    document.getElementById('answer').textContent = '素数です';
                } else {
                    document.getElementById('answer').textContent = '素数ではありません';
                }
            } else if (mode == 'bunkai') {
                bunkai(input_Number);
            } else if (mode == 'nishinhenkann') {
                nishinhenkann(input_Number);
            } else if (mode == 'jisshinhenkann') {
                jisshinhenkann(input_Number);
            }
        } else {
            document.getElementById('Number_slot').value = '';
            document.getElementById('answer').textContent = '';
        }
    }
</script>
</head>
<body style="text-align: center; font-family: sans-serif;">
<h1>素数判定・素因数分解・進数変換</h1>
<input type="text" id="Number_slot" placeholder="数字を入力">を
<select id="mode_select">
    <option value="hantei">素数か判定</option>
    <option value="bunkai">素因数分解</option>
    <option value="nishinhenkann">二進数に変換</option>
    <option value="jisshinhenkann">十進数に変換</option>
</select>
<button onclick="mode_change()">出力</button>
<p><a id="answer"></a></p>
</body>
</html>